-- default for superuser is false
CREATE ROLE regress_test_def_superuser;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_def_superuser';
          rolname           | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_def_superuser | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

CREATE ROLE regress_test_superuser WITH SUPERUSER;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_superuser';
        rolname         | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_superuser | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_superuser WITH NOSUPERUSER;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_superuser';
        rolname         | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_superuser | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_superuser WITH SUPERUSER;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_superuser';
        rolname         | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_superuser | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

-- default for inherit is true
CREATE ROLE regress_test_def_inherit;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_def_inherit';
         rolname          | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
--------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_def_inherit | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

CREATE ROLE regress_test_inherit WITH NOINHERIT;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_inherit';
       rolname        | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_inherit | f          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_inherit WITH INHERIT;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_inherit';
       rolname        | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_inherit | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_inherit WITH NOINHERIT;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_inherit';
       rolname        | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_inherit | f          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

-- default for create role is false
CREATE ROLE regress_test_def_createrole;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_def_createrole';
           rolname           | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
-----------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_def_createrole | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

CREATE ROLE regress_test_createrole WITH CREATEROLE;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_createrole';
         rolname         | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
-------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_createrole | t          | t             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_createrole WITH NOCREATEROLE;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_createrole';
         rolname         | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
-------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_createrole | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_createrole WITH CREATEROLE;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_createrole';
         rolname         | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
-------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_createrole | t          | t             | f           | f           | f              | f            |           -1 |             | 
(1 row)

-- default for create database is false
CREATE ROLE regress_test_def_createdb;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_def_createdb';
          rolname          | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
---------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_def_createdb | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

CREATE ROLE regress_test_createdb WITH CREATEDB;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_createdb';
        rolname        | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
-----------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_createdb | t          | f             | t           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_createdb WITH NOCREATEDB;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_createdb';
        rolname        | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
-----------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_createdb | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_createdb WITH CREATEDB;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_createdb';
        rolname        | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
-----------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_createdb | t          | f             | t           | f           | f              | f            |           -1 |             | 
(1 row)

-- default for can login is false for role
CREATE ROLE regress_test_def_role_canlogin;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_def_role_canlogin';
            rolname             | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
--------------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_def_role_canlogin | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

CREATE ROLE regress_test_role_canlogin WITH LOGIN;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_role_canlogin';
          rolname           | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_role_canlogin | t          | f             | f           | t           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_role_canlogin WITH NOLOGIN;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_role_canlogin';
          rolname           | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_role_canlogin | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_role_canlogin WITH LOGIN;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_role_canlogin';
          rolname           | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_role_canlogin | t          | f             | f           | t           | f              | f            |           -1 |             | 
(1 row)

-- default for can login is true for user
CREATE USER regress_test_def_user_canlogin;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_def_user_canlogin';
            rolname             | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
--------------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_def_user_canlogin | t          | f             | f           | t           | f              | f            |           -1 |             | 
(1 row)

CREATE USER regress_test_user_canlogin WITH NOLOGIN;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_user_canlogin';
          rolname           | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_user_canlogin | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER USER regress_test_user_canlogin WITH LOGIN;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_user_canlogin';
          rolname           | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_user_canlogin | t          | f             | f           | t           | f              | f            |           -1 |             | 
(1 row)

ALTER USER regress_test_user_canlogin WITH NOLOGIN;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_user_canlogin';
          rolname           | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_user_canlogin | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

-- default for replication is false
CREATE ROLE regress_test_def_replication;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_def_replication';
           rolname            | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
------------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_def_replication | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

CREATE ROLE regress_test_replication WITH REPLICATION;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_replication';
         rolname          | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
--------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_replication | t          | f             | f           | f           | t              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_replication WITH NOREPLICATION;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_replication';
         rolname          | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
--------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_replication | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_replication WITH REPLICATION;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_replication';
         rolname          | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
--------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_replication | t          | f             | f           | f           | t              | f            |           -1 |             | 
(1 row)

-- default for bypassrls is false
CREATE ROLE regress_test_def_bypassrls;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_def_bypassrls';
          rolname           | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
----------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_def_bypassrls | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

CREATE ROLE regress_test_bypassrls WITH BYPASSRLS;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_bypassrls';
        rolname         | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_bypassrls | t          | f             | f           | f           | f              | t            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_bypassrls WITH NOBYPASSRLS;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_bypassrls';
        rolname         | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_bypassrls | t          | f             | f           | f           | f              | f            |           -1 |             | 
(1 row)

ALTER ROLE regress_test_bypassrls WITH BYPASSRLS;
SELECT rolname, rolinherit, rolcreaterole, rolcreatedb, rolcanlogin, rolreplication, rolbypassrls, rolconnlimit, rolpassword, rolvaliduntil FROM pg_authid WHERE rolname = 'regress_test_bypassrls';
        rolname         | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolbypassrls | rolconnlimit | rolpassword | rolvaliduntil 
------------------------+------------+---------------+-------------+-------------+----------------+--------------+--------------+-------------+---------------
 regress_test_bypassrls | t          | f             | f           | f           | f              | t            |           -1 |             | 
(1 row)

-- clean up roles
DROP ROLE regress_test_def_superuser;
DROP ROLE regress_test_superuser;
DROP ROLE regress_test_def_inherit;
DROP ROLE regress_test_inherit;
DROP ROLE regress_test_def_createrole;
DROP ROLE regress_test_createrole;
DROP ROLE regress_test_def_createdb;
DROP ROLE regress_test_createdb;
DROP ROLE regress_test_def_role_canlogin;
DROP ROLE regress_test_role_canlogin;
DROP USER regress_test_def_user_canlogin;
DROP USER regress_test_user_canlogin;
DROP ROLE regress_test_def_replication;
DROP ROLE regress_test_replication;
DROP ROLE regress_test_def_bypassrls;
DROP ROLE regress_test_bypassrls;
